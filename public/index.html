<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Decode the Number</title>
  <link rel="stylesheet" href="css/style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PARTICLES BACKGROUND â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <canvas id="particlesCanvas"></canvas>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AMBIENT GLOW ORBS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="ambient-orbs">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AUTH SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-auth" class="screen active">
    <div class="auth-card glass-card premium-card">
      <div class="logo-section">
        <div class="logo-icon-wrapper">
          <div class="logo-ring"></div>
          <div class="logo-icon">ğŸ”¢</div>
        </div>
        <h1 class="game-title">Decode<br><span>the Number</span></h1>
        <p class="tagline">Challenge a friend. Crack the code. Win the game!</p>
      </div>

      <!-- Login Form -->
      <div id="authLoginForm" class="auth-form">
        <div class="input-group floating-label">
          <input type="text" id="loginUsername" placeholder=" " autocomplete="username" maxlength="16" />
          <label for="loginUsername">Username</label>
          <div class="input-glow"></div>
        </div>
        <div class="input-group floating-label">
          <input type="password" id="loginPassword" placeholder=" " autocomplete="current-password" />
          <label for="loginPassword">Password</label>
          <div class="input-glow"></div>
        </div>
        <button id="btnLogin" class="btn btn-primary btn-large btn-shimmer">
          <span class="btn-text">Sign In</span>
          <span class="btn-loader hidden"></span>
        </button>
        <p class="auth-switch">Don't have an account? <a href="#" id="showSignup">Create one</a></p>
      </div>

      <!-- Signup Form -->
      <div id="authSignupForm" class="auth-form hidden">
        <div class="input-group floating-label">
          <input type="text" id="signupUsername" placeholder=" " autocomplete="username" maxlength="16" />
          <label for="signupUsername">Username</label>
          <div class="input-glow"></div>
        </div>
        <div class="input-group floating-label">
          <input type="text" id="signupDisplayName" placeholder=" " maxlength="16" />
          <label for="signupDisplayName">Display Name</label>
          <div class="input-glow"></div>
        </div>
        <div class="input-group floating-label">
          <input type="password" id="signupPassword" placeholder=" " autocomplete="new-password" />
          <label for="signupPassword">Password</label>
          <div class="input-glow"></div>
        </div>
        <button id="btnSignup" class="btn btn-primary btn-large btn-shimmer">
          <span class="btn-text">Create Account</span>
          <span class="btn-loader hidden"></span>
        </button>
        <p class="auth-switch">Already have an account? <a href="#" id="showLogin">Sign in</a></p>
      </div>

      <!-- Guest Mode -->
      <div class="guest-divider">
        <span>or</span>
      </div>
      <button id="btnPlayGuest" class="btn btn-ghost btn-large">
        Play as Guest
      </button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LANDING SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-landing" class="screen">
    <div class="landing-card glass-card premium-card">
      <!-- User Profile Header -->
      <div class="profile-header" id="profileHeader">
        <div class="profile-avatar-wrap">
          <div class="avatar-ring"></div>
          <div class="profile-avatar" id="profileAvatar">ğŸ§‘</div>
        </div>
        <div class="profile-info">
          <span class="profile-name" id="profileName">Player</span>
          <span class="profile-rank" id="profileRank">Newcomer</span>
        </div>
        <button class="btn btn-icon-only" id="btnLogout" title="Logout">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
        </button>
      </div>

      <div class="online-indicator" id="onlineIndicator">
        <span class="online-dot"></span>
        <span id="onlineCount">0</span> online
      </div>

      <div class="input-group floating-label" id="guestNameGroup">
        <input type="text" id="playerName" placeholder=" " maxlength="16" />
        <label for="playerName">Your Name</label>
        <div class="input-glow"></div>
      </div>

      <div class="input-group">
        <label class="small-label">Number Length</label>
        <div class="length-selector">
          <button class="len-btn" data-len="3">3</button>
          <button class="len-btn active" data-len="4">4</button>
          <button class="len-btn" data-len="5">5</button>
          <button class="len-btn" data-len="6">6</button>
        </div>
      </div>

      <div class="landing-buttons">
        <button id="btnQuickMatch" class="btn btn-primary btn-large btn-shimmer">
          <span class="btn-icon">âš¡</span> Quick Match
        </button>
        <div class="btn-row">
          <button id="btnCreateRoom" class="btn btn-secondary">
            <span class="btn-icon">ğŸ </span> Create Room
          </button>
          <button id="btnJoinRoom" class="btn btn-secondary">
            <span class="btn-icon">ğŸšª</span> Join Room
          </button>
        </div>
      </div>

      <div id="joinRoomSection" class="join-section hidden">
        <div class="input-group floating-label">
          <input type="text" id="roomCodeInput" placeholder=" " maxlength="6" style="text-transform:uppercase" />
          <label for="roomCodeInput">Room Code</label>
          <div class="input-glow"></div>
        </div>
        <button id="btnJoinConfirm" class="btn btn-primary">Join</button>
      </div>

      <!-- Player Stats Card -->
      <div class="stats-preview hidden" id="statsPreview">
        <h4 class="stats-preview-title">Your Stats</h4>
        <div class="stats-grid">
          <div class="mini-stat"><span class="mini-stat-val" id="spGames">0</span><span class="mini-stat-label">Games</span></div>
          <div class="mini-stat"><span class="mini-stat-val" id="spWins">0</span><span class="mini-stat-label">Wins</span></div>
          <div class="mini-stat"><span class="mini-stat-val" id="spLosses">0</span><span class="mini-stat-label">Losses</span></div>
          <div class="mini-stat"><span class="mini-stat-val" id="spWinRate">0%</span><span class="mini-stat-label">Win Rate</span></div>
          <div class="mini-stat"><span class="mini-stat-val" id="spStreak">0</span><span class="mini-stat-label">Streak</span></div>
          <div class="mini-stat"><span class="mini-stat-val" id="spBest">0</span><span class="mini-stat-label">Best</span></div>
        </div>
      </div>

      <div class="landing-footer">
        <button id="btnLeaderboard" class="btn btn-ghost btn-small">ğŸ† Leaderboard</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LEADERBOARD MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="leaderboardModal" class="modal-overlay hidden">
    <div class="modal-card glass-card premium-card">
      <div class="modal-header">
        <h2>ğŸ† Leaderboard</h2>
        <button class="close-btn" id="btnCloseLeaderboard">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      <div class="leaderboard-list" id="leaderboardList">
        <p class="hint-text">Loadingâ€¦</p>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WAITING SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-waiting" class="screen">
    <div class="waiting-card glass-card premium-card">
      <div class="waiting-anim">
        <div class="radar-ring"></div>
        <div class="radar-ring r2"></div>
        <div class="radar-dot"></div>
      </div>
      <h2>Searching for Opponentâ€¦</h2>
      <p>Share this room code:</p>
      <div class="room-code-display" id="waitingRoomCode">------</div>
      <button id="btnCopyCode" class="btn btn-ghost btn-small">ğŸ“‹ Copy Code</button>
      <p class="hint-text">Or wait for a quick match player to join.</p>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SETUP SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-setup" class="screen">
    <div class="setup-card glass-card premium-card">
      <div class="setup-header">
        <div class="setup-icon">ğŸ”</div>
        <h2>Set Your Secret Number</h2>
        <p class="setup-info">Choose a <span id="setupNumLength">4</span>-digit number with <strong>no repeating digits</strong>.</p>
      </div>
      <p class="opponent-status" id="opponentStatus">Waiting for opponent to set their numberâ€¦</p>

      <div class="digit-input-section" id="digitInputSection">
        <!-- Digit boxes generated by JS -->
      </div>

      <div class="numpad" id="numpad">
        <button class="numpad-btn" data-digit="1">1</button>
        <button class="numpad-btn" data-digit="2">2</button>
        <button class="numpad-btn" data-digit="3">3</button>
        <button class="numpad-btn" data-digit="4">4</button>
        <button class="numpad-btn" data-digit="5">5</button>
        <button class="numpad-btn" data-digit="6">6</button>
        <button class="numpad-btn" data-digit="7">7</button>
        <button class="numpad-btn" data-digit="8">8</button>
        <button class="numpad-btn" data-digit="9">9</button>
        <button class="numpad-btn numpad-del" data-digit="del">âŒ«</button>
        <button class="numpad-btn" data-digit="0">0</button>
        <button class="numpad-btn numpad-confirm" data-digit="ok" id="btnConfirmSecret">âœ“</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-game" class="screen">
    <div class="game-layout">

      <!-- Top Bar -->
      <div class="game-topbar">
        <div class="player-badge you-badge">
          <span class="badge-avatar">ğŸ§‘</span>
          <span class="badge-name" id="yourNameBadge">You</span>
        </div>
        <div class="turn-indicator" id="turnIndicator">
          <span id="turnText">Your Turn</span>
        </div>
        <div class="player-badge opp-badge">
          <span class="badge-avatar">ğŸ¤–</span>
          <span class="badge-name" id="oppNameBadge">Opponent</span>
        </div>
      </div>

      <!-- Main game area -->
      <div class="game-main">

        <!-- Guess History Panel (both players) -->
        <div class="guess-history-panel glass-panel">
          <div class="panel-header">
            <h3>ğŸ“œ Guess History</h3>
            <div class="history-tabs">
              <button class="history-tab active" data-tab="yours" id="tabYours">Your Guesses</button>
              <button class="history-tab" data-tab="opponent" id="tabOpponent">Opponent's Guesses</button>
            </div>
          </div>
          <div class="history-list" id="historyYours">
            <div class="empty-history">No guesses yet. Start guessing!</div>
          </div>
          <div class="history-list hidden" id="historyOpponent">
            <div class="empty-history">Opponent hasn't guessed yet.</div>
          </div>
        </div>

        <!-- Guess Input Area -->
        <div class="guess-input-area" id="guessInputArea">
          <div class="guess-digit-boxes" id="guessDigitBoxes">
            <!-- Generated by JS -->
          </div>
          <div class="numpad" id="guessNumpad">
            <button class="numpad-btn" data-digit="1">1</button>
            <button class="numpad-btn" data-digit="2">2</button>
            <button class="numpad-btn" data-digit="3">3</button>
            <button class="numpad-btn" data-digit="4">4</button>
            <button class="numpad-btn" data-digit="5">5</button>
            <button class="numpad-btn" data-digit="6">6</button>
            <button class="numpad-btn" data-digit="7">7</button>
            <button class="numpad-btn" data-digit="8">8</button>
            <button class="numpad-btn" data-digit="9">9</button>
            <button class="numpad-btn numpad-del" data-digit="del">âŒ«</button>
            <button class="numpad-btn" data-digit="0">0</button>
            <button class="numpad-btn numpad-confirm" data-digit="ok" id="btnSubmitGuess">ğŸš€</button>
          </div>
          <div class="waiting-turn-msg hidden" id="waitingTurnMsg">
            <div class="pulse-dots">
              <span></span><span></span><span></span>
            </div>
            Waiting for opponent's guessâ€¦
          </div>
        </div>
      </div>

      <!-- Chat Toggle Button -->
      <button class="chat-toggle-btn" id="chatToggleBtn">ğŸ’¬ <span class="chat-badge hidden" id="chatBadge">0</span></button>

      <!-- Chat Panel (slide-in sidebar) -->
      <div class="chat-panel hidden" id="chatPanel">
        <div class="chat-header">
          <h3>ğŸ’¬ Chat</h3>
          <button class="close-btn" id="chatCloseBtn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
          </button>
        </div>
        <div class="chat-messages" id="chatMessages">
          <div class="chat-empty">Say hi to your opponent! ğŸ‘‹</div>
        </div>
        <div class="emoji-bar" id="emojiBar">
          <button class="emoji-btn" data-emoji="ğŸ‘">ğŸ‘</button>
          <button class="emoji-btn" data-emoji="ğŸ˜‚">ğŸ˜‚</button>
          <button class="emoji-btn" data-emoji="ğŸ”¥">ğŸ”¥</button>
          <button class="emoji-btn" data-emoji="ğŸ˜">ğŸ˜</button>
          <button class="emoji-btn" data-emoji="ğŸ¤”">ğŸ¤”</button>
          <button class="emoji-btn" data-emoji="ğŸ˜±">ğŸ˜±</button>
          <button class="emoji-btn" data-emoji="ğŸ‰">ğŸ‰</button>
          <button class="emoji-btn" data-emoji="ğŸ’ª">ğŸ’ª</button>
          <button class="emoji-btn" data-emoji="â¤ï¸">â¤ï¸</button>
          <button class="emoji-btn" data-emoji="ğŸ˜¢">ğŸ˜¢</button>
        </div>
        <div class="chat-input-row">
          <input type="text" id="chatInput" placeholder="Type a messageâ€¦" maxlength="200" />
          <button class="btn btn-send" id="btnSendChat">â¤</button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GAME OVER SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="screen-gameover" class="screen">
    <div class="gameover-card glass-card premium-card">
      <div class="confetti-container" id="confettiContainer"></div>
      <div class="gameover-glow" id="gameoverGlow"></div>
      <div id="gameoverIcon" class="gameover-icon">ğŸ†</div>
      <h2 id="gameoverTitle">You Win!</h2>
      <p id="gameoverSubtitle">Congratulations! You cracked the code!</p>

      <div class="secrets-reveal">
        <div class="secret-box">
          <span class="secret-label" id="secretLabel1">Your Number</span>
          <div class="secret-digits" id="secretValue1"></div>
        </div>
        <div class="secret-box">
          <span class="secret-label" id="secretLabel2">Opponent's Number</span>
          <div class="secret-digits" id="secretValue2"></div>
        </div>
      </div>

      <div class="guess-stats">
        <div class="stat-box">
          <span class="stat-number" id="statYourGuesses">0</span>
          <span class="stat-label">Your Guesses</span>
        </div>
        <div class="stat-box">
          <span class="stat-number" id="statOppGuesses">0</span>
          <span class="stat-label">Opponent's Guesses</span>
        </div>
      </div>

      <!-- Post-game stats -->
      <div class="postgame-stats" id="postgameStats">
        <h3 class="postgame-stats-title">ğŸ“Š Your Profile Stats</h3>
        <div class="stats-grid">
          <div class="mini-stat"><span class="mini-stat-val" id="pgGames">0</span><span class="mini-stat-label">Games</span></div>
          <div class="mini-stat"><span class="mini-stat-val" id="pgWins">0</span><span class="mini-stat-label">Wins</span></div>
          <div class="mini-stat"><span class="mini-stat-val" id="pgWinRate">0%</span><span class="mini-stat-label">Win Rate</span></div>
          <div class="mini-stat"><span class="mini-stat-val" id="pgStreak">0</span><span class="mini-stat-label">Streak</span></div>
        </div>
      </div>

      <div class="gameover-buttons">
        <button id="btnPlayAgain" class="btn btn-primary btn-large btn-shimmer">ğŸ”„ Play Again</button>
        <button id="btnExitGame" class="btn btn-ghost">ğŸšª Exit</button>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SOUND TOGGLE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <button class="sound-toggle" id="soundToggle" title="Toggle Sound">ğŸ”Š</button>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TOAST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="toastContainer" class="toast-container"></div>

  <!-- Scripts -->
  <script src="/socket.io/socket.io.js"></script>
  <script src="js/sounds.js"></script>
  <script src="js/chat.js"></script>
  <script src="js/game.js"></script>
</body>
</html>
